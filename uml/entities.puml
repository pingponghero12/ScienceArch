@startuml
' Entity definitions
entity "USERS" {
  *user_id : int <<PK>>
  --
  username : string
  description: text
  image: string
  read: int
  contributions: int
  created_at : datetime
  last_login : datetime
}

entity "USER_CREDENTIALS" {
  *credential_id : int <<PK>>
  --
  user_id : int <<FK>>
  email : string
  password_hash : string
}

USERS ||--o{ USER_CREDENTIALS : "user_id"

entity "FOLLOW" {
  *follower_id : int <<PK>>
  *user_id : int <<PK>>
}

entity "AUTHORS" {
  *author_id : int <<PK>>
  --
  name : string
  details : text
  image : string
  created_at : datetime
  updated_at : datetime
  accepted: bool
}

entity "ACTIVITIES" {
  *activity_id : int <<PK>>
  --
  user_id : int <<FK>>
  read_state : string <<FK>>
  created_at : datetime
}

entity "POSTS" {
  *post_id : int <<PK>>
  --
  user_id : int <<FK>>
  title : string
  content : text
  created_at : datetime
  updated_at : datetime
}

entity "PAPERS_USER" {
  *paper_id : int <<FK>>
  *user_id : int <<FK>>
  --
  read_on : datetime
  read_state : string <<FK>>
}

entity "PAPERS" {
  *paper_id : int <<PK>>
  --
  title : string
  description : text
  format: string
  avg_score: int
  popularity: int
  original_title: string
  published_at : datetime
  created_at : datetime
  updated_at : datetime
  accepted: bool
}

entity "PAPERS_GENRES" {
  *id : int <<PK>>
  --
  paper_id : int <<FK>>
  genre : string <<FK>>
}

entity "PAPERS_HASHTAGS" {
  *id : int <<PK>>
  --
  paper_id : int <<FK>>
  hashtag : string <<FK>>
}

entity "PAPER_SUBMISSIONS" {
  *submission_id : int <<PK>>
  --
  user_id : int <<FK>>
  paper_id : int <<FK>>
  accepted: bool
  submitted_at : datetime
}

entity "PAPER_REVISIONS" {
  *revision_id : int <<PK>>
  --
  paper_id : int <<FK>>
  user_id : int <<FK>>
  title : string
  description : text
  format: string
  revision_number : int
  created_at : datetime
  status : string
}

entity "REVISION_GENRES" {
  *id : int <<PK>>
  --
  revision_id : int <<FK>>
  genre : string <<FK>>
}

entity "REVISION_HASHTAGS" {
  *id : int <<PK>>
  --
  revision_id : int <<FK>>
  hashtag : string <<FK>>
}

entity "AUTHOR_SUBMISSIONS" {
  *author_submission_id : int <<PK>>
  --
  author_id : int <<FK>>
  accepted: bool
  submitted_at : datetime
  updated_at : datetime
}

entity "AUTHOR_REVISIONS" {
  *author_revision_id : int <<PK>>
  --
  author_id : int <<FK>>
  accepted: bool
  submitted_at : datetime
}

entity "READ_STATES" {
  *state : string <<PK>>
}

entity "GENRES" {
  *genre : string <<PK>>
}

entity "HASHTAGS" {
  *hashtag : string <<PK>>
}

' Relationships
USERS ||--|{ PAPERS_USER : "reads"
USERS ||--|{ POSTS : "creates"
USERS ||--|{ ACTIVITIES : "performs"
USERS ||--|{ PAPER_SUBMISSIONS : "submits"

PAPERS ||--|| AUTHORS : "written by"
PAPERS ||--|{ PAPERS_USER : "is read by"
PAPERS ||--|{ PAPER_SUBMISSIONS : "can be submitted as"
PAPERS ||--|{ PAPERS_GENRES : "categorized by"
PAPERS ||--|{ PAPERS_HASHTAGS : "tagged with"

AUTHORS ||--|{ AUTHOR_SUBMISSIONS : "can be submitted as"
AUTHORS ||--|{ AUTHOR_REVISIONS : "proposes"

PAPERS_USER }|--|| READ_STATES : "has state"

PAPERS_GENRES }|--|| GENRES : "references"
PAPERS_HASHTAGS }|--|| HASHTAGS : "references"
ACTIVITIES }|--|| READ_STATES : "references"
USERS }|--|| FOLLOW : "references"

PAPERS ||--|{ PAPER_REVISIONS : "has"
PAPER_REVISIONS ||--|{ REVISION_GENRES : "proposes"
PAPER_REVISIONS ||--|{ REVISION_HASHTAGS : "proposes"
REVISION_GENRES }|--|| GENRES : "references"
REVISION_HASHTAGS }|--|| HASHTAGS : "references"
USERS ||--|{ PAPER_REVISIONS : "creates"

@enduml
